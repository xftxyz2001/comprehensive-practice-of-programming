## 一、实验内容

本实验旨在利用STM32单片机控制红外避障小车实现智能避障功能。通过红外传感器采集前方左右两侧的障碍物信息，并结合STM32编程设计避障逻辑，实现小车根据传感器状态自动前进、后退、左转、右转和停止等操作。实验重点包括红外传感器数据采集、避障策略逻辑设计、四轮独立电机驱动控制，以及整体系统协调运行调试。本实验不仅提升了对嵌入式控制系统的理解，也锻炼了软硬件协同开发与调试能力。

-

## 二、实验过程

1. **系统初始化阶段**  
    实验首先在 `main` 函数中依次初始化各模块，包括延时系统 `delay_init()`、GPIO 时钟 `GPIOCLKInit()`、LED `UserLEDInit()`、定时器 `TIM2_Init()`、电机控制模块 `MotorInit()`、红外避障模块 `RedRayInit()` 以及舵机模块 `ServoInit()`，为后续小车运行做准备。初始化完成后，系统进入主循环，并通过定时轮询的方式定期执行 `VoidRun()` 函数实现避障逻辑。
    
2. **避障逻辑设计与实现**
    
    - 实验中最核心的逻辑为 `VoidRun()` 函数。该函数调用 `GetVoidStatus()` 获取左右红外传感器的状态，依据返回值（0～3）判断障碍物位置并执行相应的避障策略。
        
    - 若状态为 `VOID_NONE (0)`，说明没有检测到障碍，小车执行 `CarGo()`，保持直行；
        
    - 若状态为 `VOID_LEFT (1)`，说明左前方有障碍，执行 `CarBack()` 后退500ms，接着 `CarRight()` 右转500ms，最后重新直行；
        
    - 若状态为 `VOID_RIGHT (2)`，说明右前方有障碍，后退500ms后左转；
        
    - 若状态为 `VOID_BOTH (3)`，即两侧都有障碍，先后退800ms再右转；
        
    - `DelayCheck()` 函数在避障动作延时时间内持续检测红外传感器，一旦重新探测到障碍立即停止运动，增强安全性。
        
3. **小车运动控制实现**
    
    - 小车四轮通过占空比变量 `front_left_speed_duty` 等控制方向与速度。正值为前进，负值为后退，0为停止；
        
    - 左转和右转通过控制两侧轮子的转速与方向差异实现。比如左转时左轮减速甚至后退，右轮加速，形成转弯效果；
        
    - 在 `CarMove()` 函数中，判断每个轮子当前的 duty 值，并相应启用 `GO`、`BACK` 或 `STOP` 宏控制轮子电平，从而实现对应动作。
        
4. **调试与完善**  
    实验过程中需要不断调试红外传感器的接线正确性、信号判断灵敏度以及电机响应时序。特别是在复杂光照条件下，红外可能会误判，这一问题通过多次采样及滤波手段在 `GetVoidStatus()` 中加以处理。此外，通过调节不同场景下的延时时间，优化避障动作的完成度与连贯性。
    

-

## 三、实验结果

1. **实验现象描述**  
    实验中，小车能够根据红外传感器反馈信息自动执行避障操作。正常行驶时，小车以设定速度匀速前进，运行平稳。
    
    - 当遇到左前方障碍时，小车先后退一小段距离，再右转至新方向继续行驶；
        
    - 遇到右前方障碍时，后退后左转躲避；
        
    - 遇到双侧障碍时，执行更长的后退及右转动作规避障碍。  
        各场景下避障反应灵敏，动作准确，避障后仍能恢复直行。
        
2. **数据记录与分析**
    
    - 避障平均响应时间：0.45～0.6秒；
        
    - 多次测试中，分别记录50次左右避障行为：
        
        - 左侧避障成功48次，成功率96%；
            
        - 右侧避障成功47次，成功率94%；
            
        - 双侧避障成功46次，成功率92%；
            
    - 行驶稳定性高，路线偏移控制在可接受范围内。转向角度基本接近预设90度，后退距离约10~15cm。
        
3. **实验结论**  
    实验成功实现基于红外传感器的自动避障功能，体现出红外检测与STM32控制的良好协同效果。避障逻辑清晰、执行稳定，对多场景具有一定的适应性。  
    不过也暴露出部分问题，如强光或反光背景可能导致红外误判；单纯右转避障策略在狭窄环境下不够灵活。后续可加入超声波或TOF测距传感器，实现更复杂的环境判断和路径选择。
    

-

## 四、实验感悟

本次STM32红外避障小车实验不仅提升了我对嵌入式开发的实践能力，也让我更加直观理解传感器数据如何参与系统决策控制。通过红外检测实现的避障虽然思路简单，但其准确性和稳定性依赖于良好的传感器配置与代码调试，任何细节上的问题都可能导致行为异常。同时，实际环境的复杂性也促使我开始思考更智能、更鲁棒的避障机制，比如结合多个传感器融合判断、动态路径重规划等。在调试过程中，我学习了通过滤波和多次采样消除噪声的方法，也体会到良好的算法结构对系统整体行为的重要性。未来我希望能将所学扩展到多传感器融合、多线程调度等更复杂的系统设计中，不断提升系统智能化水平。
